[{"hosts": "all", "tasks": [{"name": "[master] Installing the dashboard", "shell": "k3s kubectl get service -n kubernetes-dashboard kubernetes-dashboard || k3s kubectl create -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.5.1/aio/deploy/recommended.yaml", "args": {}}, {"name": "copy", "copy": {"dest": "dashboard.admin-user.yml", "content": "\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: admin-user\n  namespace: kubernetes-dashboard\n"}}, {"name": "copy", "copy": {"dest": "dashboard.admin-user-role.yml", "content": "\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: admin-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: admin-user\n  namespace: kubernetes-dashboard\n"}}, {"name": "shell", "shell": "k3s kubectl get serviceaccounts -n kubernetes-dashboard admin-user || k3s kubectl create -f dashboard.admin-user.yml", "args": {}}, {"name": "shell", "shell": "k3s kubectl get clusterrolebindings -n kubernetes-dashboard admin-user || k3s kubectl create -f dashboard.admin-user-role.yml", "args": {}}, {"name": "token", "shell": "k3s kubectl -n kubernetes-dashboard describe secret admin-user-token | grep '^token'", "args": {}}, {"name": "shell", "async": 31536000, "poll": 0, "shell": "ps aux | grep 'kubectl proxy' | grep -v 'kubectl proxy' || kubectl proxy --address='0.0.0.0' --accept-hosts='.*'", "args": {}}], "gather_facts": false, "strategy": "linear"}]